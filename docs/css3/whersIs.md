# CSS :is() 和 :where() 伪类详解

`:is()` 和 `:where()` 是 CSS Selectors Level 4 引入的两个非常实用的伪类函数，它们主要用于简化复杂的选择器列表，但在**权重计算 (Specificity)** 上有着本质的区别。

## 1. 语法与基本用法

它们的语法完全一致，都接受一个选择器列表作为参数。

```css
/* 传统写法 */
header h1,
header h2,
header h3,
main h1,
main h2,
main h3,
footer h1,
footer h2,
footer h3 {
  color: #333;
}

/* 使用 :is() 或 :where() 简化 */
:is(header, main, footer) :is(h1, h2, h3) {
  color: #333;
}
```

这不仅减少了代码量，还提高了可读性。

## 2. :is() 伪类

**特性**：

- **匹配规则**：匹配传入的选择器列表中任意一个选择器匹配的元素。
- **容错性**：如果列表中的某个选择器无效，`:is()` 不会使整个规则失效，而是忽略无效的选择器（宽松解析）。
- **权重计算**：`:is()` 伪类本身的权重取决于**参数列表中权重最高**的那个选择器。

### 权重示例

```css
/* 
  假设 HTML: <div class="box"><p>text</p></div>
*/

/* 权重计算 */
/* 
  :is(.box, #app) p 
  权重 = max(.box权重, #app权重) + p权重
       = max(0-1-0, 1-0-0) + 0-0-1
       = 1-0-0 + 0-0-1
       = 1-0-1
*/
:is(.box, #app) p {
  color: red;
}

/* 
  .box p 
  权重 = 0-1-0 + 0-0-1 = 0-1-1
*/
.box p {
  color: blue;
}

/* 结果：文字显示红色，因为 1-0-1 > 0-1-1 */
```

即使实际匹配的是 `.box`（类选择器），但因为 `:is()` 的参数中包含了 `#app`（ID 选择器），所以整个 `:is()` 的权重提升到了 ID 选择器的级别。

## 3. :where() 伪类

**特性**：

- **匹配规则**：与 `:is()` 完全相同。
- **容错性**：与 `:is()` 完全相同。
- **权重计算**：`:where()` 的权重**始终为 0**。它不会增加任何权重，无论参数里有什么选择器。

### 权重示例

```css
/* 
  :where(.box, #app) p 
  权重 = 0 + p权重
       = 0-0-1
*/
:where(.box, #app) p {
  color: red;
}

/* 
  p 
  权重 = 0-0-1
*/
p {
  color: blue;
}

/* 结果：取决于定义顺序（后来居上），因为权重都是 0-0-1 */
```

`:where()` 非常适合用于定义**默认样式**或**重置样式**（CSS Reset），因为它的低权重特性使得开发者在使用这些组件或样式库时，可以非常轻松地覆盖默认样式，而不需要使用更高权重的选择器或 `!important`。

## 4. 区别总结

| 特性                   | :is()                              | :where()                                      |
| :--------------------- | :--------------------------------- | :-------------------------------------------- |
| **功能**               | 简化选择器列表，匹配任意参数       | 简化选择器列表，匹配任意参数                  |
| **权重 (Specificity)** | **等于参数列表中权重最高的选择器** | **总是 0**                                    |
| **应用场景**           | 分组选择器，同时希望保持一定的权重 | CSS Reset，基础库默认样式，希望易于覆盖的场景 |

## 5. 浏览器兼容性

现代浏览器（Chrome 88+, Firefox 78+, Safari 14+）都已经很好地支持了这两个伪类。对于需要支持 IE 等老旧浏览器的项目，可能需要使用 PostCSS 等工具进行转换（但这通常会展开选择器，失去减少代码量的优势）。
